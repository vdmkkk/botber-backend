{
  email {$CADDY_EMAIL}
  # For first-time testing without rate limits, uncomment the staging CA:
  # acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

backend.botberi.ru {
  encode gzip zstd

  # Proxy all requests to the FastAPI container by service name + port
  reverse_proxy api:{$SERVICE_PORT}

  # Optional: add a quick health check endpoint served by Caddy itself
  @health path /healthz
  handle @health {
    respond 200
  }

  log {
    output stdout
    format console
  }
}
